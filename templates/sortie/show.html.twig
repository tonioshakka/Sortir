{% extends 'base.html.twig' %}

{% block title %}Sortie{% endblock %}

{% block body %}
    <h1 class="former-titre">{{ sortie.nom }}</h1>

    <div class="former_form">
        <ul id="sortie_data">
            <li class="sortie-data"><span class="sortie-value">{{ sortie.dateHeureDebut | date('d F Y H:i:s') }}</span></li>
            <li class="sortie-data"><span class="sortie-value">{{ sortie.lieu.ville }}</span></li>
            <li class="sortie-data"><span class="sortie-value"> {{ sortie.lieu.rue }}</span></li>
            {% if sortie.dateLimiteInscription %}
                <li class="sortie-data"><span class="sortie-field">Clôture: </span><span class="sortie-value">{{ sortie.dateLimiteInscription | date('d F Y H:i:s') }}</span></li>
            {% endif %}
            {% if sortie.nbInscriptionsMax %}
                <li class="sortie-data"><span class="sortie-value">{{ sortie.nbInscriptionsMax }} place</span></li>
            {% endif %}
            {% if sortie.duree %}
                <li class="sortie-data"><span class="sortie-value">{{ sortie.duree }} minutes</span></li>
            {% endif %}
        </ul>
        {% if sortie.infosSortie %}
            <h3>Description et info</h3>
            <p>{{ sortie.infosSortie or sortie.motifAnnuler }}</p>
        {% endif %}
    </div>

    <a href="{{ path('app_sortie_index') }}">Retour à la liste</a>

    {% if not isOrganisateur %}
    {% if (not sortie.participant.contains(participant) and sortie.dateLimiteInscription|date('U') > "now"|date('U') or sortie.dateLimiteInscription is null) and (sortie.nbInscriptionsMax > 0 or sortie.nbInscriptionsMax is null) and sortie.etat.id == 2 %}
        <a class="create_class" href="{{ path('app_sortie_inscription', {'id': sortie.id , 'token': csrf_token('inscription'~sortie.id)}) }}">S'inscrire</a>
    {% endif %}
    {% if (sortie.participant.contains(participant) and (sortie.dateLimiteInscription|date('U') > "now"|date('U') or sortie.dateLimiteInscription is null) and sortie.dateHeureDebut|date('U') > "now"|date('U') )and sortie.etat.id == 2 %}
        <a class="create_class" href="{{ path('app_sortie_desistement', {'id': sortie.id , 'token': csrf_token('desistement'~sortie.id)}) }}">Annuler mon inscription</a>
    {% endif %}
    {% endif %}




    {% if isOrganisateur %}
        <a href="{{ path('app_sortie_edit', {'id': sortie.id}) }}">Éditer</a>
    {% endif %}

    {% if is_granted('ROLE_ADMIN') %}
        <a href="{{ path('app_sortie_delete', {'id': sortie.id, 'token': csrf_token('supprimerSortie'~sortie.id)}) }}">Supprimer la sortie</a>
    {% endif %}


    <h3>Participants inscrits</h3>
    <ul>
        {% for participant in sortie.participant %}
            <li>
                <a href="{{ path('app_participant_show', { 'id': participant.id }) }}">
                    {{ participant.nom }} {{ participant.prenom }}
                </a>
            </li>
        {% endfor %}
    </ul>

{% endblock %}
